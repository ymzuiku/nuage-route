var R=Object.create,m=Object.defineProperty,v=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,C=Object.getOwnPropertyNames,x=Object.getOwnPropertyDescriptor;var E=e=>m(e,"__esModule",{value:!0});var M=(e,r)=>()=>(r||(r={exports:{}},e(r.exports,r)),r.exports);var N=(e,r,o)=>{if(E(e),r&&typeof r=="object"||typeof r=="function")for(let n of C(r))!T.call(e,n)&&n!=="default"&&m(e,n,{get:()=>r[n],enumerable:!(o=x(r,n))||o.enumerable});return e},_=e=>e&&e.__esModule?e:N(m(e!=null?R(v(e)):{},"default",{value:e,enumerable:!0}),e);var y=M((h,$)=>{(function(e,r){typeof h=="object"&&typeof $!="undefined"?r(h):typeof define=="function"&&define.amd?define(["exports"],r):r((e=e||self).queryString={})})(h,function(e){"use strict";function r(s){try{return decodeURIComponent(s.replace(/\+/g," "))}catch(i){return null}}function o(s){try{return encodeURIComponent(s)}catch(i){return null}}function n(s,i){if(!s)return null;for(var u,f=/([^=?&]+)=?([^&]*)/g,c={};u=f.exec(s);){var d=r(u[1]),l=r(u[2]);d===null||l===null||d in c||(i||(l=isNaN(Number(l))?l:Number(l)),c[d]=l)}return c}function p(s,i){i===void 0&&(i="");var u,f,c=[];for(f in typeof i!="string"&&(i="?"),s)if(Object.prototype.hasOwnProperty.call(s,f)){if((u=s[f])||u!=null&&!isNaN(u)||(u=""),f=encodeURIComponent(f),u=encodeURIComponent(u),f===null||u===null)continue;c.push(f+"="+u)}return c.length?i+c.join("&"):""}var a={parse:n,stringify:p,decode:r,encode:o};e.decode=r,e.default=a,e.encode=o,e.parse=n,e.stringify=p,Object.defineProperty(e,"__esModule",{value:!0})})});var g=_(y()),w=document.createElement("div");w.style.cssText="width:100%; height:100%";var t={$$:{beforePush:[],beforeRender:[],paramsCache:{},paramsRouter:{},nowRenderPath:"",routerMap:{},liveRouterFns:[],getLiveRoute:()=>{let e=t.$$.liveRouterFns.length,r=t.params();for(let o=0;o<e;o++){let n=t.$$.liveRouterFns[o](r);if(n)return n}return null}},target:w,qs:g.default,params:()=>{let e=window.location.href,r=t.$$.paramsCache[e];if(r)return r;let o=t.getPath(),n={};Object.keys(t.$$.paramsRouter).forEach(i=>{if(o.indexOf(i)===0){let f=t.$$.paramsRouter[i].replace(/:/g,"").replace(i,""),c=o.replace(i,""),d=f.split("/"),l=c.split("/");d.forEach((P,b)=>{n[P]=l[b]||""})}});let p=window.location.hash.split("?"),a=window.location.hash.replace("#","");if(!p[1]){let i={path:o,url:a,...n};return t.$$.paramsCache[e]=i,i}let s={url:a,path:o,...n,...t.qs.parse(p[1])};return t.$$.paramsCache[e]=s,s},loading:()=>"loading...",errorPath:"/",listenEvents:[],beforeRender:e=>{t.$$.beforeRender.push(e)},beforePush:e=>{t.$$.beforePush.push(e)},use:function(e,r,o){/:/.test(e)&&(t.$$.paramsRouter[e.split(":")[0]]=e),t.$$.routerMap[e]=r,o!==void 0&&setTimeout(()=>{r.__promising||r().then(n=>{t.$$.routerMap[e]=n})},o)},push:async(e,r)=>{if(typeof t.beforePush=="function")for(let o of t.$$.beforePush)e=await Promise.resolve(o(e));typeof e=="string"&&(window.history.pushState(null,"","#"+e),t.render(),r&&window.scrollTo({top:0}))},replace:async(e,r)=>{if(typeof t.beforePush=="function")for(let o of t.$$.beforePush)e=await Promise.resolve(o(e));typeof e=="string"&&(window.history.replaceState(null,"","#"+e),t.render(),r&&window.scrollTo({top:0}))},pop:()=>{window.history.back(),t.render()},getPath:()=>(window.location.hash.split("#")[1]||"/").split("?")[0],render:async()=>{if(!t.$$.routerMap[t.errorPath]){console.error("Undefined route.errorPath:",t.errorPath);return}let e=t.getPath();if(typeof t.beforeRender=="function")for(let a of t.$$.beforeRender)await Promise.resolve(a(e));if(t.$$.nowRenderPath===e)return;let r=t.$$.routerMap[e];if(r||Object.keys(t.$$.paramsRouter).forEach(a=>{if(e.indexOf(a)===0){let s=t.$$.paramsRouter[a];r=t.$$.routerMap[s]}}),!r){t.replace(t.errorPath+"?"+e);return}t.$$.nowRenderPath=e;let o=setTimeout(()=>{t.target.append(t.loading())},200);r.__promising=!0;let n=await Promise.resolve(r());n.default&&(n=n.default);let p=t.params();if(t.listenEvents.forEach(a=>{a(p)}),typeof n=="function"){clearTimeout(o);let a=n();a.then?a.then(s=>{s&&s.nodeName&&(t.target.innerText="",t.target.appendChild(s))}):(t.target.innerText="",t.target.appendChild(a))}else clearTimeout(o),n.then?n.then(a=>{a&&a.nodeName&&(t.target.innerText="",t.target.appendChild(a))}):(t.target.innerText="",t.target.appendChild(n))}};window.addEventListener("popstate",function(){t.render()});var O=t;export{O as default,t as route};
