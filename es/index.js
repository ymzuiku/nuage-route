var T=Object.create,y=Object.defineProperty,v=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,C=Object.getOwnPropertyNames,M=Object.getOwnPropertyDescriptor;var x=e=>y(e,"__esModule",{value:!0});var N=(e,r)=>()=>(r||(r={exports:{}},e(r.exports,r)),r.exports);var S=(e,r,o)=>{if(x(e),r&&typeof r=="object"||typeof r=="function")for(let t of C(r))!E.call(e,t)&&t!=="default"&&y(e,t,{get:()=>r[t],enumerable:!(o=M(r,t))||o.enumerable});return e},_=e=>e&&e.__esModule?e:S(y(e!=null?T(v(e)):{},"default",{value:e,enumerable:!0}),e);var g=N((m,$)=>{(function(e,r){typeof m=="object"&&typeof $!="undefined"?r(m):typeof define=="function"&&define.amd?define(["exports"],r):r((e=e||self).queryString={})})(m,function(e){"use strict";function r(s){try{return decodeURIComponent(s.replace(/\+/g," "))}catch(i){return null}}function o(s){try{return encodeURIComponent(s)}catch(i){return null}}function t(s,i){if(!s)return null;for(var l,c=/([^=?&]+)=?([^&]*)/g,u={};l=c.exec(s);){var h=r(l[1]),f=r(l[2]);h===null||f===null||h in u||(i||(f=isNaN(Number(f))?f:Number(f)),u[h]=f)}return u}function p(s,i){i===void 0&&(i="");var l,c,u=[];for(c in typeof i!="string"&&(i="?"),s)if(Object.prototype.hasOwnProperty.call(s,c)){if((l=s[c])||l!=null&&!isNaN(l)||(l=""),c=encodeURIComponent(c),l=encodeURIComponent(l),c===null||l===null)continue;u.push(c+"="+l)}return u.length?i+u.join("&"):""}var a={parse:t,stringify:p,decode:r,encode:o};e.decode=r,e.default=a,e.encode=o,e.parse=t,e.stringify=p,Object.defineProperty(e,"__esModule",{value:!0})})});var w=_(g()),P=document.createElement("div");P.style.cssText="width:100%; height:100%";var d={};window.cacheScrollTop=d;var n={$$:{beforePush:[],beforeRender:[],paramsCache:{},paramsRouter:{},nowRenderPath:"",routerMap:{},liveRouterFns:[],getLiveRoute:()=>{let e=n.$$.liveRouterFns.length,r=n.params();for(let o=0;o<e;o++){let t=n.$$.liveRouterFns[o](r);if(t)return t}return null}},target:P,qs:w.default,params:()=>{let e=window.location.href,r=n.$$.paramsCache[e];if(r)return r;let o=n.getPath(),t={};Object.keys(n.$$.paramsRouter).forEach(i=>{if(o.indexOf(i)===0){let c=n.$$.paramsRouter[i].replace(/:/g,"").replace(i,""),u=o.replace(i,""),h=c.split("/"),f=u.split("/");h.forEach((b,R)=>{t[b]=f[R]||""})}});let p=window.location.hash.split("?"),a=window.location.hash.replace("#","");if(!p[1]){let i={path:o,url:a,...t};return n.$$.paramsCache[e]=i,i}let s={url:a,path:o,...t,...n.qs.parse(p[1])};return n.$$.paramsCache[e]=s,s},loading:()=>"loading...",errorPath:"/",listenEvents:[],beforeRender:e=>{n.$$.beforeRender.push(e)},beforePush:e=>{n.$$.beforePush.push(e)},use:function(e,r,o){/:/.test(e)&&(n.$$.paramsRouter[e.split(":")[0]]=e),n.$$.routerMap[e]=r,o!==void 0&&setTimeout(()=>{r.__promising||r().then(t=>{n.$$.routerMap[e]=t})},o)},scroll:{saveScrollTop:e=>{e?d[window.location.href]=e.scrollTop:d[window.location.href]=window.scrollY},replaceScrollTop:e=>new Promise(r=>{requestAnimationFrame(()=>{let o=d[window.location.href];o&&(e?(e.scrollTo(0,o),window.scrollElement=void 0):window.scrollTo({top:o})),r(o||0)})}),getLastScrollTop:()=>d[window.location.href]||0},push:async e=>{if(typeof n.beforePush=="function")for(let r of n.$$.beforePush)e=await Promise.resolve(r(e));typeof e=="string"&&(window.history.pushState(null,"","#"+e),n.render())},replace:async e=>{if(typeof n.beforePush=="function")for(let r of n.$$.beforePush)e=await Promise.resolve(r(e));typeof e=="string"&&(window.history.replaceState(null,"","#"+e),n.render())},pop:()=>{window.history.back(),n.render(),d[window.location.href]=void 0},getPath:()=>(window.location.hash.split("#")[1]||"/").split("?")[0],render:async()=>{if(!n.$$.routerMap[n.errorPath]){console.error("Undefined route.errorPath:",n.errorPath);return}let e=n.getPath();if(typeof n.beforeRender=="function")for(let a of n.$$.beforeRender)await Promise.resolve(a(e));if(n.$$.nowRenderPath===e)return;let r=n.$$.routerMap[e];if(r||Object.keys(n.$$.paramsRouter).forEach(a=>{if(e.indexOf(a)===0){let s=n.$$.paramsRouter[a];r=n.$$.routerMap[s]}}),!r){n.replace(n.errorPath+"?"+e);return}n.$$.nowRenderPath=e;let o=setTimeout(()=>{n.target.append(n.loading())},200);r.__promising=!0;let t=await Promise.resolve(r());t.default&&(t=t.default);let p=n.params();if(n.listenEvents.forEach(a=>{a(p)}),typeof t=="function"){clearTimeout(o);let a=t();a.then?a.then(s=>{s&&s.nodeName&&(n.target.innerText="",n.target.appendChild(s))}):(n.target.innerText="",n.target.appendChild(a))}else clearTimeout(o),t.then?t.then(a=>{a&&a.nodeName&&(n.target.innerText="",n.target.appendChild(a))}):(n.target.innerText="",n.target.appendChild(t))}};window.addEventListener("popstate",function(){n.render()});var L=n;export{L as default,n as route};
