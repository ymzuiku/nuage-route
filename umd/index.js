!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("querystring-number")):"function"==typeof define&&define.amd?define(["querystring-number"],r):(e=e||self).vanillaRoute=r(e.qs)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var s=function(){return(s=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function r(a,i,u,s){return new(u=u||Promise)(function(e,r){function t(e){try{o(s.next(e))}catch(e){r(e)}}function n(e){try{o(s.throw(e))}catch(e){r(e)}}function o(r){r.done?e(r.value):new u(function(e){e(r.value)}).then(t,n)}o((s=s.apply(a,i||[])).next())})}function l(t,n){var o,a,i,e,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function r(r){return function(e){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,a=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=0<(i=u.trys).length&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=n.call(t,u)}catch(e){r=[6,e],a=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,e])}}}var t=void 0,n=document.createElement("div");n.style.cssText="width:100%; height:100%";var o={};window.st=o;var c={$$:{beforePush:[],beforeRender:[],paramsCache:{},paramsRouter:{},nowRenderPath:"",routerMap:{},liveRouterFns:[],getLiveRoute:function(){for(var e=c.$$.liveRouterFns.length,r=c.params(),t=0;t<e;t++){var n=c.$$.liveRouterFns[t](r);if(n)return n}return null}},target:n,qs:e,params:function(){var e=window.location.href,r=c.$$.paramsCache[e];if(r)return r;var a=c.getPath(),i={};Object.keys(c.$$.paramsRouter).forEach(function(e){if(0===a.indexOf(e)){var r=c.$$.paramsRouter[e].replace(/:/g,"").replace(e,""),t=a.replace(e,""),n=r.split("/"),o=t.split("/");n.forEach(function(e,r){i[e]=o[r]||""})}});var t=window.location.hash.split("?"),n=window.location.hash.replace("#","");if(!t[1]){var o=s({path:a,url:n},i);return c.$$.paramsCache[e]=o}var u=s({url:n,path:a},i,c.qs.parse(t[1]));return c.$$.paramsCache[e]=u},loading:function(){return"loading..."},errorPath:"/",listenEvents:[],beforeRender:function(e){c.$$.beforeRender.push(e)},beforePush:function(e){c.$$.beforePush.push(e)},use:function(r,e,t){/:/.test(r)&&(c.$$.paramsRouter[r.split(":")[0]]=r),c.$$.routerMap[r]=e,void 0!==t&&setTimeout(function(){e.__promising||e().then(function(e){c.$$.routerMap[r]=e})},t)},scroll:{saveScrollTop:function(e){o[window.location.href]=e?e.scrollTop:window.scrollY},replaceScrollTop:function(t){return new Promise(function(r){requestAnimationFrame(function(){var e=o[window.location.href];e&&(t?(t.scrollTo(0,e),window.scrollElement=void 0):window.scrollTo({top:e})),r(e||0)})})},getLastScrollTop:function(){return o[window.location.href]||0}},push:function(o){return r(t,void 0,void 0,function(){var r,t,n;return l(this,function(e){switch(e.label){case 0:if("function"!=typeof c.beforePush)return[3,4];r=0,t=c.$$.beforePush,e.label=1;case 1:return r<t.length?(n=t[r],[4,Promise.resolve(n(o))]):[3,4];case 2:o=e.sent(),e.label=3;case 3:return r++,[3,1];case 4:return"string"!=typeof o||(window.history.pushState(null,"","#"+o),c.render()),[2]}})})},replace:function(o){return r(t,void 0,void 0,function(){var r,t,n;return l(this,function(e){switch(e.label){case 0:if("function"!=typeof c.beforePush)return[3,4];r=0,t=c.$$.beforePush,e.label=1;case 1:return r<t.length?(n=t[r],[4,Promise.resolve(n(o))]):[3,4];case 2:o=e.sent(),e.label=3;case 3:return r++,[3,1];case 4:return"string"!=typeof o||(window.history.replaceState(null,"","#"+o),c.render()),[2]}})})},pop:function(){window.history.back(),c.render(),o[window.location.href]=void 0},getPath:function(){return(window.location.hash.split("#")[1]||"/").split("?")[0]},render:function(){return r(t,void 0,void 0,function(){var t,r,n,o,a,i,u,s;return l(this,function(e){switch(e.label){case 0:if(c.$$.routerMap[c.errorPath]||console.error("Undefined route.errorPath:",c.errorPath),t=c.getPath(),"function"!=typeof c.beforeRender)return[3,4];r=0,n=c.$$.beforeRender,e.label=1;case 1:return r<n.length?(o=n[r],[4,Promise.resolve(o(t))]):[3,4];case 2:e.sent(),e.label=3;case 3:return r++,[3,1];case 4:return c.$$.nowRenderPath===t?[2]:((a=c.$$.routerMap[t])||Object.keys(c.$$.paramsRouter).forEach(function(e){if(0===t.indexOf(e)){var r=c.$$.paramsRouter[e];a=c.$$.routerMap[r]}}),a?(c.$$.nowRenderPath=t,i=setTimeout(function(){c.target.append(c.loading())},200),a.__promising=!0,[4,Promise.resolve(a())]):(c.replace(c.errorPath+"?"+t),[2]));case 5:return(u=e.sent()).default&&(u=u.default),s=c.params(),c.listenEvents.forEach(function(e){e(s)}),"function"==typeof u?(clearTimeout(i),c.target.innerText="",c.target.appendChild(u())):(clearTimeout(i),c.target.innerText="",c.target.appendChild(u)),[2]}})})}};return window.addEventListener("popstate",function(){c.render()}),c});
//# sourceMappingURL=index.js.map
